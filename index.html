<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Volley Stats Pro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="manifest" href="manifest.webmanifest">
    <meta name="theme-color" content="#0b5ed7">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" defer></script>
    <link rel="icon" type="image/png" href="icon-192.png">
</head>
<body>

<div id="app" class="fade-in">

    <header class="app-header">
        <div class="title-block">
            <h1>üèê Volley Stats Pro</h1>
            <p class="subtitle">Statistiche, campo, punteggi live</p>
        </div>
        <div class="header-actions">
            <button id="themeToggle" title="Tema chiaro/scuro">üåì</button>
            <button id="reset" class="danger">üîÑ Reset Dati</button>
        </div>
    </header>

    <section class="info-bar">
        <div class="teams">
            <input id="teamA" placeholder="Team A">
            <input id="teamB" placeholder="Team B">
        </div>
        <div class="meta">
            <label>
                Data:
                <input type="date" id="matchDate">
            </label>
            <label>
                Luogo:
                <input type="text" id="matchPlace" placeholder="Palestra, citt√†...">
            </label>
        </div>
    </section>

    <section class="top-widgets">
        <div class="sets-card card">
            <h2>Set & punteggio live</h2>
            <div class="set-container">
                <button class="set-btn active" data-set="1">Set 1</button>
                <button class="set-btn" data-set="2">Set 2</button>
                <button class="set-btn" data-set="3">Set 3</button>
                <button class="set-btn" data-set="4">Set 4</button>
                <button class="set-btn" data-set="5">Set 5</button>
            </div>
            <p class="small-note">Set attivo: <span id="labelSet">1</span></p>

            <div class="live-score">
                <div class="live-score-row">
                    <span id="labelTeamA_live">Team A</span>
                    <div class="score-controls">
                        <button class="score-btn" data-team="A" data-delta="-1">-</button>
                        <span class="score-value" id="scoreA">0</span>
                        <button class="score-btn" data-team="A" data-delta="1">+</button>
                    </div>
                </div>
                <div class="live-score-row">
                    <span id="labelTeamB_live">Team B</span>
                    <div class="score-controls">
                        <button class="score-btn" data-team="B" data-delta="-1">-</button>
                        <span class="score-value" id="scoreB">0</span>
                        <button class="score-btn" data-team="B" data-delta="1">+</button>
                    </div>
                </div>
            </div>

            <div class="sets-summary">
                <h3>Risultato set</h3>
                <ul id="setsResultList"></ul>
            </div>
        </div>

        <div class="summary-card card">
            <h2>Riepilogo rapido</h2>
            <div class="summary-grid">
                <div class="summary-item">
                    <span class="label">Giocatori</span>
                    <span class="value" id="summaryPlayers">0</span>
                </div>
                <div class="summary-item">
                    <span class="label">Azioni totali</span>
                    <span class="value" id="summaryActions">0</span>
                </div>
                <div class="summary-item">
                    <span class="label">Miglior attacco</span>
                    <span class="value" id="summaryBestAtt">-</span>
                </div>
                <div class="summary-item">
                    <span class="label">Miglior ricezione</span>
                    <span class="value" id="summaryBestRcz">-</span>
                </div>
            </div>
        </div>

        <div class="export-card card">
            <h2>Esportazione</h2>
            <div class="pdf-buttons">
                <button id="pdfSet">üìÑ PDF Set</button>
                <button id="pdfFinale">üìò PDF Finale</button>
            </div>
            <p class="small-note">Dati salvati in locale su questo dispositivo.</p>
        </div>
    </section>

    <!-- CAMPO DI GIOCO -->
    <section class="court-section card">
        <div class="court-header">
            <h2>Campo, rotazioni e sostituzioni</h2>
            <div class="court-controls">
                <button id="rotateClockwise">‚Üª Rotazione</button>
                <button id="switchSide">‚áÑ Cambio campo</button>
            </div>
        </div>
        <p class="small-note">
            Le prime 6 giocatrici della lista sono in campo (posizioni 1‚Äì6).  
            Tocca una giocatrice in campo per sostituirla con un‚Äôaltra dalla lista.
        </p>

        <div class="court-wrapper">
            <div id="court" class="court">
                <div class="court-net"></div>

                <div class="court-side court-side-a">
                    <div class="pos pos-4" data-pos="4"></div>
                    <div class="pos pos-3" data-pos="3"></div>
                    <div class="pos pos-2" data-pos="2"></div>
                    <div class="pos pos-5" data-pos="5"></div>
                    <div class="pos pos-6" data-pos="6"></div>
                    <div class="pos pos-1" data-pos="1"></div>
                </div>

                <div class="court-side court-side-b">
                    <!-- lato avversario solo grafico -->
                </div>
            </div>
        </div>
    </section>

    <section class="players-section card">
        <div class="players-header">
            <h2>Giocatori</h2>
            <div class="add-player">
                <input id="playerName" placeholder="Nome giocatore">
                <button id="addPlayer">‚ûï Aggiungi</button>
            </div>
        </div>

        <div id="report">
            <div class="report-header">
                <div><strong>Team A:</strong> <span id="labelTeamA"></span></div>
                <div><strong>Team B:</strong> <span id="labelTeamB"></span></div>
                <div><strong>Set:</strong> <span id="labelSetReport">1</span></div>
                <div><strong>Data:</strong> <span id="labelDate"></span></div>
                <div><strong>Luogo:</strong> <span id="labelPlace"></span></div>
            </div>

            <div class="table-wrapper">
                <table id="playersTable">
                    <thead>
                        <tr>
                            <th>Giocatore</th>
                            <th>attPos</th><th>attNeg</th>
                            <th>difPos</th><th>difNeg</th>
                            <th>battPos</th><th>battNeg</th>
                            <th>ricezPos</th><th>ricezNeg</th>
                            <th>muro</th><th>muroPunto</th><th>muroFuori</th>
                            <th>Papere</th>
                            <th>% Att</th><th>% Dif</th><th>% Bat</th><th>% Rcz</th><th>% Muro+</th>
                            <th>Azioni</th>
                        </tr>
                    </thead>
                    <tbody id="playersBody"></tbody>

                    <tfoot>
                        <tr id="totalsRow">
                            <td><b>Totali</b></td>
                            <td>0</td><td>0</td>
                            <td>0</td><td>0</td>
                            <td>0</td><td>0</td>
                            <td>0</td><td>0</td>
                            <td>0</td><td>0</td><td>0</td>
                            <td>0</td>
                            <td>0%</td><td>0%</td><td>0%</td><td>0%</td><td>0%</td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </section>

</div>

<script src="script.js"></script>
<script>
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js')
            .catch(err => console.log('SW error', err));
    });
}
</script>

</body>
</html>
